<div ng-controller="Our.CodeEditorController">
    <div class="file" ng-repeat="file in model.value">
        <div class="file-editor" ng-class="{'auto-height': file.config.viewportMargin == Infinity}">
            <header class="file-header">
                <input type="text" class="file-name" ng-model="file.name" ng-change="filenameChange($index)" placeholder="Filename including extension" />
                <button type="button" ng-if="canRemove()" class="btn btn-danger file-remove" ng-click="removeFile($index)" title="Remove file"><i class="icon icon-trash"></i></button>
                <ul class="file-actions" ng-if="!model.config.defautls.hideActions">
                    <li>
                        <select ng-model="file.config.indentWithTabs"
                                ng-options="o.v as o.n group by 'Indent mode' for o in [{n: 'Spaces', v:false}, {n: 'Tabs', v:true}]"></select>
                    </li>
                    <li>
                        <select ng-model="file.config.tabSize"
                                ng-options="o.v as o.n group by 'Indent size' for o in [{n: '2', v:2}, {n: '4', v:4}, {n:'8', v:8}]"></select>
                    </li>
                    <li>
                        <select ng-model="file.config.lineWrapping"
                                ng-options="o.v as o.n group by 'Line wrap mode' for o in [{n: 'Soft wrap', v:true}, {n: 'No wrap', v:false}]"></select>
                    </li>
                </ul>
            </header>
            <div class="file-text">
                <umb-codemirror options="file.options"
                               callback="loaded"
                               ng-model="file.text">
                </umb-codemirror>
            </div>
            <footer class="file-footer">
                <!--<button class="toggle-height" type="button" title="Toggle height" ng-click="toggleAutoHeight($index)"></button>-->
                <ul>
                    <li>
                        <span ng-bind="file.config.mode.mime"></span>
                    </li>
                </ul>
            </footer>
        </div>
    </div>

    <a ng-hide="limitReached()" class="btn btn-default" ng-click="addFile()" title="Add file">Add file</a>
</div>